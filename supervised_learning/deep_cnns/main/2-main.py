#!/usr/bin/env python3

import tensorflow.keras as K
identity_block = __import__('2-identity_block').identity_block

if __name__ == '__main__':
    X = K.Input(shape=(224, 224, 256))
    Y = identity_block(X, [64, 64, 256])
    model = K.models.Model(inputs=X, outputs=Y)
    model.summary()

# Expected Output:
# Model: "model"
# __________________________________________________________________________________________________
# Layer (type)                    Output Shape         Param #     Connected to                     
# ==================================================================================================
# input_1 (InputLayer)            [(None, 224, 224, 25 0                                            
# __________________________________________________________________________________________________
# conv2d (Conv2D)                 (None, 224, 224, 64) 16448       input_1[0][0]                    
# __________________________________________________________________________________________________
# batch_normalization (BatchNorma (None, 224, 224, 64) 256         conv2d[0][0]                     
# __________________________________________________________________________________________________
# activation (Activation)         (None, 224, 224, 64) 0           batch_normalization[0][0]        
# __________________________________________________________________________________________________
# conv2d_1 (Conv2D)               (None, 224, 224, 64) 36928       activation[0][0]                 
# __________________________________________________________________________________________________
# batch_normalization_1 (BatchNor (None, 224, 224, 64) 256         conv2d_1[0][0]                   
# __________________________________________________________________________________________________
# activation_1 (Activation)       (None, 224, 224, 64) 0           batch_normalization_1[0][0]      
# __________________________________________________________________________________________________
# conv2d_2 (Conv2D)               (None, 224, 224, 256 16640       activation_1[0][0]               
# __________________________________________________________________________________________________
# batch_normalization_2 (BatchNor (None, 224, 224, 256 1024        conv2d_2[0][0]                   
# __________________________________________________________________________________________________
# add (Add)                       (None, 224, 224, 256 0           batch_normalization_2[0][0]      
#                                                                  input_1[0][0]                    
# __________________________________________________________________________________________________
# activation_2 (Activation)       (None, 224, 224, 256 0           add[0][0]                        
# ==================================================================================================
# Total params: 71,552
# Trainable params: 70,784
# Non-trainable params: 768
# __________________________________________________________________________________________________