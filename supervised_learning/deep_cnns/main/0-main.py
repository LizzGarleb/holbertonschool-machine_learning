#!/usr/bin/env python3

import tensorflow.keras as K
inception_block = __import__('0-inception_block').inception_block

if __name__ == '__main__':
    X = K.Input(shape=(224, 224, 3))
    Y = inception_block(X, [64, 96, 128, 16, 32, 32])
    model = K.models.Model(inputs=X, outputs=Y)
    model.summary()

# Expected Output:
# Model: "model"
# __________________________________________________________________________________________________
# Layer (type)                    Output Shape         Param #     Connected to                     
# ==================================================================================================
# input_1 (InputLayer)            [(None, 224, 224, 3) 0                                            
# __________________________________________________________________________________________________
# conv2d_1 (Conv2D)               (None, 224, 224, 96) 384         input_1[0][0]                    
# __________________________________________________________________________________________________
# conv2d_3 (Conv2D)               (None, 224, 224, 16) 64          input_1[0][0]                    
# __________________________________________________________________________________________________
# max_pooling2d (MaxPooling2D)    (None, 224, 224, 3)  0           input_1[0][0]                    
# __________________________________________________________________________________________________
# conv2d (Conv2D)                 (None, 224, 224, 64) 256         input_1[0][0]                    
# __________________________________________________________________________________________________
# conv2d_2 (Conv2D)               (None, 224, 224, 128 110720      conv2d_1[0][0]                   
# __________________________________________________________________________________________________
# conv2d_4 (Conv2D)               (None, 224, 224, 32) 12832       conv2d_3[0][0]                   
# __________________________________________________________________________________________________
# conv2d_5 (Conv2D)               (None, 224, 224, 32) 128         max_pooling2d[0][0]              
# __________________________________________________________________________________________________
# concatenate (Concatenate)       (None, 224, 224, 256 0           conv2d[0][0]                     
#                                                                  conv2d_2[0][0]                   
#                                                                  conv2d_4[0][0]                   
#                                                                  conv2d_5[0][0]                   
# ==================================================================================================
# Total params: 124,384
# Trainable params: 124,384
# Non-trainable params: 0
# __________________________________________________________________________________________________